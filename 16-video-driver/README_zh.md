*你可能想提前 Google 的概念：VGA 字符单元、屏幕偏移*

**目标：在屏幕上写入字符串**

最后，我们将能够在屏幕上输出文本。这节课包含比平常多一点的代码，所以让我们一步一步来。

打开 `drivers/screen.h`，你会看到我们为 VGA 卡驱动程序定义了一些常量和三个公共函数，一个用于清除屏幕，另一对用于写入字符串，著名的 `kprint` 代表"内核打印"

现在打开 `drivers/screen.c`。它以私有辅助函数的声明开始，我们将使用这些函数来辅助我们的 `kprint` 内核 API。

有两个我们在上一课中学到的 I/O 端口访问例程，`get` 和 `set_cursor_offset()`。

然后是直接操作视频内存的例程，`print_char()`

最后，有三个小的辅助函数将行和列转换为偏移量，反之亦然。


kprint_at
---------

`kprint_at` 可以使用 `col` 和 `row` 的 `-1` 值调用，这表示我们将在当前光标位置打印字符串。

它首先为 col/row 和偏移量设置三个变量。然后它遍历 `char*` 并使用当前坐标调用 `print_char()`。

请注意，`print_char` 本身返回下一个光标位置的偏移量，我们将其重用于下一个循环。

`kprint` 基本上是 `kprint_at` 的包装器



print_char
----------

像 `kprint_at` 一样，`print_char` 允许 cols/rows 为 `-1`。在这种情况下，它使用 `ports.c` 例程从硬件检索光标位置。

`print_char` 还处理换行符。在这种情况下，我们将光标偏移定位到下一行的第 0 列。

记住，VGA 单元占用两个字节，一个用于字符本身，另一个用于属性。


kernel.c
--------

我们的新内核最终能够打印字符串。

它测试正确的字符定位，跨越多行，换行符，最后它尝试在屏幕边界之外写入。那时会发生什么？

在下一课中，我们将学习如何滚动屏幕。
